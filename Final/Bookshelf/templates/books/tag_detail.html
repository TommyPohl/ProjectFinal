{% extends 'base.html' %}
{% block title %}Knihy se ≈°t√≠tkem {{ tag.name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>üè∑Ô∏è Knihy se ≈°t√≠tkem: {{ tag.name }}</h2>
  {% if user.is_authenticated %}
    <div>
      <a href="{% url 'edit-tag' tag.slug %}" class="btn btn-sm btn-warning me-2">‚úèÔ∏è Upravit</a>
      <a href="{% url 'delete-tag' tag.slug %}" class="btn btn-sm btn-danger">üóëÔ∏è Smazat</a>
    </div>
  {% endif %}
</div>

<div class="row">
  {% for book in books %}
    <div class="col-md-3 mb-3">
      <a href="{% url 'book-detail' book.pk %}" class="book-card">
        <div class="card-body d-flex flex-column justify-content-center align-items-center">
          <h5 class="book-title">{{ book.title }}</h5>
          <p class="book-author">{{ book.author }}</p>

          {% if book.avg_rating %}
            <div class="book-rating">
              {% with book.avg_rating|floatformat:0 as stars %}
                {% for i in "12345" %}
                  <span class="star {% if forloop.counter <= stars %}filled{% else %}empty{% endif %}">
                    {% if forloop.counter <= stars %}‚≠ê{% else %}‚òÜ{% endif %}
                  </span>
                {% endfor %}
                ({{ book.avg_rating|floatformat:1 }}‚òÖ)
              {% endwith %}
            </div>
          {% else %}
            <p class="book-rating text-muted">Zat√≠m nehodnoceno</p>
          {% endif %}
        </div>
      </a>
    </div>
  {% empty %}
    <p class="text-muted">≈Ω√°dn√© knihy nejsou oznaƒçeny t√≠mto ≈°t√≠tkem.</p>
  {% endfor %}
</div>
{% endblock %}
